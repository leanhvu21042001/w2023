<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Week 12: Testing | MAD9124</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Full-stack: API Development">
    
    <link rel="preload" href="/w2023/assets/css/0.styles.494dd125.css" as="style"><link rel="preload" href="/w2023/assets/js/app.60650c02.js" as="script"><link rel="preload" href="/w2023/assets/js/3.4b0adc00.js" as="script"><link rel="preload" href="/w2023/assets/js/5.9ee2e4c7.js" as="script"><link rel="preload" href="/w2023/assets/js/15.c072e039.js" as="script"><link rel="preload" href="/w2023/assets/js/16.98a772dc.js" as="script"><link rel="prefetch" href="/w2023/assets/js/10.f600ef9c.js"><link rel="prefetch" href="/w2023/assets/js/11.59cce816.js"><link rel="prefetch" href="/w2023/assets/js/12.9a8f0e36.js"><link rel="prefetch" href="/w2023/assets/js/13.b4c9d204.js"><link rel="prefetch" href="/w2023/assets/js/14.1bbcf46f.js"><link rel="prefetch" href="/w2023/assets/js/17.2696ccfd.js"><link rel="prefetch" href="/w2023/assets/js/18.4c772c8d.js"><link rel="prefetch" href="/w2023/assets/js/19.0ed82ce5.js"><link rel="prefetch" href="/w2023/assets/js/2.5288beb2.js"><link rel="prefetch" href="/w2023/assets/js/20.770d7140.js"><link rel="prefetch" href="/w2023/assets/js/21.6ef972b3.js"><link rel="prefetch" href="/w2023/assets/js/22.ef81ef04.js"><link rel="prefetch" href="/w2023/assets/js/23.417c179f.js"><link rel="prefetch" href="/w2023/assets/js/24.bdbbc474.js"><link rel="prefetch" href="/w2023/assets/js/25.036dac97.js"><link rel="prefetch" href="/w2023/assets/js/26.cfed9991.js"><link rel="prefetch" href="/w2023/assets/js/27.f330a31c.js"><link rel="prefetch" href="/w2023/assets/js/28.49afbf1d.js"><link rel="prefetch" href="/w2023/assets/js/29.37e36a86.js"><link rel="prefetch" href="/w2023/assets/js/30.32dcbee6.js"><link rel="prefetch" href="/w2023/assets/js/31.0af45ea5.js"><link rel="prefetch" href="/w2023/assets/js/32.7ce3bc44.js"><link rel="prefetch" href="/w2023/assets/js/33.589d5da0.js"><link rel="prefetch" href="/w2023/assets/js/34.fd5d60cc.js"><link rel="prefetch" href="/w2023/assets/js/35.eb1cbce0.js"><link rel="prefetch" href="/w2023/assets/js/36.2c862154.js"><link rel="prefetch" href="/w2023/assets/js/37.5398f93e.js"><link rel="prefetch" href="/w2023/assets/js/38.cf75b57c.js"><link rel="prefetch" href="/w2023/assets/js/39.9092bb5a.js"><link rel="prefetch" href="/w2023/assets/js/4.a4d15534.js"><link rel="prefetch" href="/w2023/assets/js/6.62eb8be9.js"><link rel="prefetch" href="/w2023/assets/js/7.109c5752.js"><link rel="prefetch" href="/w2023/assets/js/8.8ff7fd07.js"><link rel="prefetch" href="/w2023/assets/js/9.42e2f10f.js">
    <link rel="stylesheet" href="/w2023/assets/css/0.styles.494dd125.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/w2023/" class="home-link router-link-active"><!----> <span class="site-name">MAD9124</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/w2023/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/w2023/modules/" class="nav-link router-link-active">
  Modules
</a></div><div class="nav-item"><a href="/w2023/deliverables/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/w2023/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/w2023/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/w2023/modules/" class="nav-link router-link-active">
  Modules
</a></div><div class="nav-item"><a href="/w2023/deliverables/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/w2023/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Introduction</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Content Modules</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/w2023/modules/" aria-current="page" class="sidebar-link">Table of contents</a></li><li><a href="/w2023/modules/week1/" class="sidebar-link">Week 1: Introduction &amp; Review</a></li><li><a href="/w2023/modules/week2/" class="sidebar-link">Week 2: Node Modules &amp; Express</a></li><li><a href="/w2023/modules/week3/" class="sidebar-link">Week 3: RESTful APIs</a></li><li><a href="/w2023/modules/week4/" class="sidebar-link">Week 4: Middleware functions</a></li><li><a href="/w2023/modules/week5/" class="sidebar-link">Week 5: Data persistance</a></li><li><a href="/w2023/modules/week6/" class="sidebar-link">Week 6: Object Data Modeling</a></li><li><a href="/w2023/modules/week7/" class="sidebar-link">Week 7: Data security</a></li><li><a href="/w2023/modules/break-week/" class="sidebar-link">Break Week</a></li><li><a href="/w2023/modules/week8/" class="sidebar-link">Week 8: Access Control with JWT</a></li><li><a href="/w2023/modules/week9/" class="sidebar-link">Week 9: JWT Review</a></li><li><a href="/w2023/modules/week10/" class="sidebar-link">Week 10: Consistent Error Handling</a></li><li><a href="/w2023/modules/week11/" class="sidebar-link">Week 11: Production Preparation</a></li><li><a href="/w2023/modules/week12/" aria-current="page" class="active sidebar-link">Week 12: Testing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/w2023/modules/week12/#getting-organized-with-postman" class="sidebar-link">Getting organized with Postman</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/w2023/modules/week12/#workspaces" class="sidebar-link">Workspaces</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week12/#collections" class="sidebar-link">Collections</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week12/#saving-requests" class="sidebar-link">Saving requests</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week12/#variables" class="sidebar-link">Variables</a></li></ul></li><li class="sidebar-sub-header"><a href="/w2023/modules/week12/#exercise-12-1" class="sidebar-link">Exercise 12-1</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week12/#postman-testing-scripts" class="sidebar-link">Postman testing scripts</a></li><li class="sidebar-sub-header"><a href="/w2023/modules/week12/#for-next-week" class="sidebar-link">For next week</a></li></ul></li><li><a href="/w2023/modules/week13/" class="sidebar-link">Week 13: Production Deployment</a></li><li><a href="/w2023/modules/week14/" class="sidebar-link">Week 14: Final Lab</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1><span class="week">Week 12</span><br> <span class="title">Testing</span></h1> <h2 id="getting-organized-with-postman"><a href="#getting-organized-with-postman" class="header-anchor">#</a> Getting organized with Postman</h2> <p>We have used Postman to do manual testing of our projects throughout the course, but we have barely scratched the surface of what Postman can do. It is time to leverage more features to help keep our testing well organized and eliminate some of the manual &quot;cut and paste&quot; of results from one test to another.</p> <h3 id="workspaces"><a href="#workspaces" class="header-anchor">#</a> Workspaces</h3> <p>When you first start using Postman it sets up a default workspace called <em>My Workspace</em>. This lets you get started right away. But like any other digital tool, this can get cluttered pretty quickly. You can think of the <strong>workspaces</strong> feature as a filing cabinet. It is a way to contain collections of related work.</p> <p>In a development shop or as a freelancer, you might want to create one for each client you are doing work for. I created a workspace for this class. You will notice at the top of all of my Postman screenshots it says <em>MAD9124</em>.</p> <h4 id="create-a-workspace"><a href="#create-a-workspace" class="header-anchor">#</a> Create a workspace</h4> <p>You can create a new workspace by clicking the title of the current workspace and then choosing the <strong>Create New</strong> option.</p> <p><img src="/w2023/assets/img/screenshot-postman-workspaces.521ddf2f.png" alt="screenshot of Postman workspace list"> <img src="/w2023/assets/img/screenshot-postman-create-workspace.493fd80b.png" alt="screenshot of Postman create workspace dialog"></p> <p>Give the workspace a name ( e.g. MAD9124 ) and optional description to help you remember what it is for later, and then click the <strong>Create this workspace</strong> button. This will create and switch to the new empty workspace.</p> <h3 id="collections"><a href="#collections" class="header-anchor">#</a> Collections</h3> <p>Within a workspace Postman has a <strong>Collections</strong> feature to help sub-divide your work. To continue the earlier analogy, collections are like drawers in the filing cabinet. I created a collection for each of the projects that we worked on during class. The left-hand column of the Postman workspace lists all of the collections.</p> <h4 id="create-a-collection"><a href="#create-a-collection" class="header-anchor">#</a> Create a collection</h4> <p>Click the plus icon just below the word collections to create a new one.</p> <p><img src="/w2023/assets/img/screenshot-postman-collections-list.79138708.png" alt="screenshot of Postman collections panel"></p> <p><img src="/w2023/assets/img/screenshot-postman-create-collection.2701ceae.png" alt="screenshot of Postman create collection dialog"></p> <p>Give the collection a meaningful name. I usually name mine to match the GitHub project name. You can also setup some collection-wide configuration like <strong>variables</strong>, or automated test scripts that should run either before or after every request.</p> <h3 id="saving-requests"><a href="#saving-requests" class="header-anchor">#</a> Saving requests</h3> <p>As you are testing your web service API, it is a good idea to create a separate request tab for each route action. Then you can save those request tabs to your collection using the grey <strong>save</strong> button at the right of the send button. When saving, the default name is the URL (e.g. localhost:3030/api/pizzas). To make it easier to find what you are looking for, give it a more friendly name (e.g. Create a Pizza).</p> <p>Postman also lets you create folders inside you collections to help keep things tidy. A good practice is to create a folder for each API resource (e.g. pizzas, or orders).</p> <p><img src="/w2023/assets/img/screenshot-postman-collection-folders.18adcece.png" alt="screenshot of Postman collection folders"></p> <p>Then the next time you need to test a particular route action, simply double click the saved request and all of the default body data and header information will already be set. Change whatever parameters are required for your test (e.g. a missing required property to check validation errors) and click the send button.</p> <h3 id="variables"><a href="#variables" class="header-anchor">#</a> Variables</h3> <p>One of the most error prone and time consuming things about testing a series of API requests is that we often need to copy data from the results of one request to the body or the header of another request. A good example is after running the login request, we need to copy the returned JWT into the <strong>Authorization</strong> header of every other API request.</p> <p>Postman solves this problem with <em>variables</em>. We can create environment variables in each collection that can then be inserted into the request using the double braces syntax – sometimes called moustache syntax.</p> <h4 id="create-a-new-environment"><a href="#create-a-new-environment" class="header-anchor">#</a> Create a new environment</h4> <p>Much like we can manage different environment variables for our node application, Postman lets us define one or more environments for our collections. Each environment can have different variable/value sets.</p> <p><img src="/w2023/assets/img/screenshot-postman-environment-buttons.d75f7cdc.png" alt="screenshot of Postman environment buttons"></p> <p>In the top right corner, just above the send button, there is an environment drop-down menu. It will initially say <em>No Environment</em>. Clicking the <strong>gear icon</strong> to the right will bring up the <strong>Manage Environments</strong> panel where you can create a new one. I called mine <strong>PizzaShop-dev</strong>.</p> <h4 id="create-a-variable"><a href="#create-a-variable" class="header-anchor">#</a> Create a variable</h4> <p>Once you have created your environment(s), they will appear in the list on the <strong>Manage Environments</strong> panel. Click on the name of your environment and then you should see a table to create or modify variables.</p> <p>Create a variable called <strong>token</strong>. You can leave the initial value blank.</p> <p><img src="/w2023/assets/img/screenshot-postman-environment-variables.8ba8009b.png" alt="screenshot of Postman environment variables"></p> <h4 id="use-a-variable"><a href="#use-a-variable" class="header-anchor">#</a> Use a variable</h4> <div><p>We can then have Postman insert the value of a variable anywhere in the request tab by wrapping the variable name in double braces - e.g. <code>{{token}}</code></p> <p>To see how this works, send the login request and copy the returned token value into the <strong>current value</strong> column of the <em>token</em> environment variable. Now update the <em>Authorization</em> header of an API route (e.g. POST /api/ingredients) to have the value <code>Bearer {{token}}</code>.</p></div><p>When you click <strong>Send</strong>, Postman will automatically insert the current value of the <em>token</em> variable in the value of the <em>Authorization</em> header. You can do this for ALL of your API routes that require the authentication token, and now when you login to create a new token you only have to copy the result one-time, to the variable. All other routes using the variable will just work!</p> <h4 id="quick-look"><a href="#quick-look" class="header-anchor">#</a> Quick look</h4> <p>To quickly see or update the values of the current environment's variables, click on the <strong>eye icon</strong>.</p> <p><img src="/w2023/assets/img/screenshot-postman-variables-quick-look.fd8ae4bc.png" alt="screenshot of Postman environment quick look"></p> <h2 id="exercise-12-1"><a href="#exercise-12-1" class="header-anchor">#</a> Exercise 12-1</h2> <div class="custom-block tip"><p class="custom-block-title">THIS IS NOT REQUIRED FOR W20</p> <p>This exercise is just for practice. There will be no grade assigned for this exercise in the W20 term.</p></div> <div><p>Setup a collection with at least two saved requests. One should have the <em>Authorization</em> header set to <code>Bearer {{token}}</code>.
Create an environnement for your collection and create a <em>token</em> variable.</p></div><p>Take a screenshot showing all of the above and submit it on Brightspace. Here is an example screenshot.</p> <p><img src="/w2023/assets/img/screenshot-exercise-submission.7f23daf8.png" alt="screenshot of Postman exercise completion"></p> <h2 id="postman-testing-scripts"><a href="#postman-testing-scripts" class="header-anchor">#</a> Postman testing scripts</h2> <p>Postman also lets us write some <a href="https://learning.postman.com/docs/postman/scripts/test-scripts/" target="_blank" rel="noopener noreferrer">automated testing with JavaScript<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. It exposes the <a href="https://www.chaijs.com/api/bdd/" target="_blank" rel="noopener noreferrer">Chai BDD<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> testing syntax.</p> <p>This can be tremendously powerful and we will look at this topic a bit more in week 14. But for now let's look at one trick to automatically capture the JWT after a successful login request and then set the value of the <em>token</em> variable.</p> <p><img src="/w2023/assets/img/screenshot-postman-tests.e0773ce0.png" alt="screenshot of Postman tests"></p> <p>In the <strong>Tests</strong> tab of the login request (POST /auth/tokens) add this short JavaScript function.</p> <div class="language-js extra-class"><pre class="language-js"><code>pm<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Response data contains token'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Check if we really got a token</span>
  pm<span class="token punctuation">.</span>response<span class="token punctuation">.</span>to<span class="token punctuation">.</span>have<span class="token punctuation">.</span><span class="token function">jsonBody</span><span class="token punctuation">(</span><span class="token string">'data.token'</span><span class="token punctuation">)</span>

  <span class="token comment">// Extract the token from the JSON body of the response</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>data<span class="token punctuation">}</span> <span class="token operator">=</span> pm<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// Save the token in a collection variable</span>
  pm<span class="token punctuation">.</span>environment<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>token<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Now you can just send the login request (with valid email and password) and the <em>token</em> variable will automatically be updated and you don't have to copy and paste the token ever again!</p> <h2 id="for-next-week"><a href="#for-next-week" class="header-anchor">#</a> For next week</h2> <p>Before next week's class, please read these additional online resources.</p> <ul><li><p><a href="https://drive.google.com/file/d/1puV-awBU5uYvsMYITIk35cFAHAeFgDqU/view" target="_blank" rel="noopener noreferrer">Postman Quick Reference Guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://www.youtube.com/watch?v=pAD11I3k9q0" target="_blank" rel="noopener noreferrer">Postman mock servers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>video</span></p></li></ul> <div class="custom-block warning"><p class="custom-block-title">Assignment Reminder</p> <p><a href="/w2023/deliverables/final.html">Final project - GIFTR</a> is due by <strong>5:00 pm April 17, 2020</strong>.<br>
This is the final deadline. There will be no extensions.</p> <p>Counts for 30% of your MAD9124 final grade.</p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/29/2020, 6:44:56 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/w2023/modules/week11/" class="prev">
        Week 11: Production Preparation
      </a></span> <span class="next"><a href="/w2023/modules/week13/">
        Week 13: Production Deployment
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/w2023/assets/js/app.60650c02.js" defer></script><script src="/w2023/assets/js/3.4b0adc00.js" defer></script><script src="/w2023/assets/js/5.9ee2e4c7.js" defer></script><script src="/w2023/assets/js/15.c072e039.js" defer></script><script src="/w2023/assets/js/16.98a772dc.js" defer></script>
  </body>
</html>
